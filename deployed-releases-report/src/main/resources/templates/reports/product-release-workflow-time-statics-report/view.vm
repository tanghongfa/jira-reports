<style>
.report-info {
    font-family: "Verdana", Times, serif;
}
div.aui-message.info {
    display:none;
}
table {
  background-color: transparent;
}
table {
  border-spacing: 0;
  border-collapse: collapse;
}
.table>thead:first-child>tr:first-child>th {
    border-top: 0;
}
.table>thead>tr>th {
  vertical-align: bottom;
  border-bottom: 2px solid #ddd;
}
.table>tbody>tr>td, .table>tbody>tr>th, .table>tfoot>tr>td, .table>tfoot>tr>th, .table>thead>tr>td, .table>thead>tr>th {
  padding: 8px;
  line-height: 1.42857143;
  vertical-align: middle;
  border-top: 1px solid #ddd;
}
.table-report {
  width: 100%;
  text-align: center;
}
.table-striped>tbody>tr:nth-of-type(odd) {
  background-color: #f9f9f9;
}
.report-section-header {
  border-bottom: 1px solid #ccc;
  padding-bottom: 5px;
  background-color: #fff;
  font-size: 16px;
  font-weight: bold;
  margin-bottom: 8px;
}
.table-desc tr>td:first-child{
    color: #707070;
    width: 150px;
}
.btn-default {
  color: #333;
  background-color: #fff;
  border-color: #ccc;
}
.btn {
  display: inline-block;
  padding: 6px 12px;
  margin-bottom: 0;
  font-size: 14px;
  font-weight: 400;
  line-height: 1.42857143;
  text-align: center;
  white-space: nowrap;
  vertical-align: middle;
  -ms-touch-action: manipulation;
  touch-action: manipulation;
  cursor: pointer;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
  background-image: none;
  border: 1px solid transparent;
  border-radius: 4px;
}
.btn-default {
  color: #333;
  background-color: #fff;
  border-color: #ccc;
  text-decoration: none;
}
button, input, select, textarea {
  font-family: inherit;
  font-size: inherit;
  line-height: inherit;
}
button, html input[type=button], input[type=reset], input[type=submit] {
  -webkit-appearance: button;
  cursor: pointer;
}
button, select {
  text-transform: none;
}
button {
  overflow: visible;
}
button, input, optgroup, select, textarea {
  margin: 0;
  font: inherit;
  color: inherit;
}
[role=button] {
  cursor: pointer;
}
.btn-default:focus,
.btn-default:active,
.btn-default.active
{
  background-color: #ffffff;
  text-decoration: none;
}
.btn-default:hover
{
  background-color: #ebebeb;
  text-decoration: none;
}
</style>
<script>
AJS.$(document).ready(function() {
    AJS.$("#download-excel-link").attr("href", AJS.$(".excel a").attr("href"));
});
</script>
<div style="padding: 5px">
<div style="height: 12px;">
<a id="download-excel-link" class="btn btn-default" href="#" role="button" style="float:right; clear:right;">Download Report as Excel</a>
</div>
<!-- Display the report configuration -->
<div class="report-section-header">
Report Information:
</div>
<div>
   <p></p>
   <table class="table-desc">
   <tr><td>Project Name:</td><td>$projectName</td></tr>
   <tr><td>Time Period:</td><td>$dateTimeFormatter.format($startDate) - $dateTimeFormatter.format($endDate)</td></tr>
   <tr><td>Result Set:</td>
        <td>
            #if($deploymentResult == "success")
                Success Deployments Only
            #else
                All Deployments
            #end
        </td>
   </tr>
   <tr><td>Generated On:</td><td>$dateTimeFormatter.format($today)</td></tr>
   </table>
</div>
<br />

<!--Report Details section-->
<div class="report-section-header">
Report Details:
</div>
<table class="table table-striped table-report">
    <thead>
	<tr>
        <th>Issue Id</th>
        <th>Title</th>
        <th>Component</th>
        <th>Version</th>
        #foreach ($env in $environments)
        <th>$env</th>
        #end  
    </tr>
	</thead>	
    #foreach ($issue in $issues)
        #if($issue.isEverDeployed())
            <tr>
            	<td>
            		<a href="/jira/browse/$issue.getIssueKey()">$issue.getIssueKey()</a>
            	</td>    	
            	<td>
            		$issue.getIssueTitle()
            	</td> 
            	<td>
            	    #foreach ($comp in $issue.getDeployedComponent())
            	    <p>$comp</p>
            	    #end            		
            	</td>
            	<td>
            		#foreach ($compVer in $issue.getDeployedVersion())
                    <p>$compVer</p>
                    #end  
            	</td>
            	#foreach ($env in $environments)
            	#set ($activity = false)
            	<td>
                    #if($deploymentResult == "success")
            		  #set ($activity = $issue.getLastSuccessDeploymentToEnv($env))
            		#else
            		  #set ($activity = $issue.getLastDeploymentToEnv($env))
            		#end
            		#if($activity)
            	       $dateTimeFormatter.format($activity.getActionDate())
            	    #else 
            	       ---
            		#end
            	</td>
            	#end      
            </tr>
        #end
    #end
</table>
</div>